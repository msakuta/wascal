"use strict";(self.webpackChunkrust_webpack_template=self.webpackChunkrust_webpack_template||[]).push([[100],{100:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__);var _pkg_index_bg_wasm__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(923),_pkg_index_bg_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(903),_codemirror_language__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(472),_codemirror_state__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(585),_parser__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(802),codemirror__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(554),codemirror__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(898);(0,_pkg_index_bg_js__WEBPACK_IMPORTED_MODULE_0__.lI)(_pkg_index_bg_wasm__WEBPACK_IMPORTED_MODULE_1__);const consoleElem=document.getElementById("console");async function runCommon(e){consoleElem.value="";const t=document.getElementById("canvas"),n=t.getBoundingClientRect();t.getContext("2d").clearRect(0,0,n.width,n.height);const o=view.state.doc.toString(),c=performance.now();try{e(o)}catch(e){consoleElem.value=e}const r=performance.now();document.getElementById("timeMessage").innerHTML=`Execution time: ${(r-c).toFixed(1)} ms (See <a href="#Time">notes</a>)`}async function callFunc(e,t){const n=e.exports[t];console.log("Calling wasm");const o=functionElems[t];let c,r=[];for(let e=0;e<n.length;e++)r.push(o[e].value);const _=performance.now();outputBuf="";try{c=n.apply(this,r),outputBuf+=`\nResult: ${c}`}catch(e){outputBuf=e}const l=performance.now();consoleElem.value=outputBuf,document.getElementById("timeMessage").innerHTML=`Execution time: ${(l-_).toFixed(1)} ms (See <a href="#Time">notes</a>)`}let outputBuf="";const opts={console:{log:console.log},output:{putc:e=>{outputBuf+=String.fromCharCode(e)}},canvas:{set_fill_style:(e,t,n)=>{const o=e=>e<16?`0${e.toString(16)}`:255<e?"ff":e.toString(16);document.getElementById("canvas").getContext("2d").fillStyle=`#${o(e)}${o(t)}${o(n)}`},rectangle:(e,t,n,o)=>{document.getElementById("canvas").getContext("2d").fillRect(e,t,n,o)}}};let functionElems={};document.getElementById("parseAst").addEventListener("click",(()=>runCommon((e=>{const t=(0,_pkg_index_bg_js__WEBPACK_IMPORTED_MODULE_0__.Vv)(e);document.getElementById("console").value=t})))),document.getElementById("compile").addEventListener("click",(()=>runCommon((async source=>{let bind;try{const[wasm,bindStr]=(0,_pkg_index_bg_js__WEBPACK_IMPORTED_MODULE_0__.wE)(source);bind=eval(bindStr),opts.output.print=e=>outputBuf+=bind.returnString(e)+"\n",bind.init(wasm,opts).catch((e=>{consoleElem.value=`Compile failed: ${e}`})),consoleElem.value=`Compiled WebAssembly module in ${wasm.length} bytes.`}catch(e){consoleElem.value=`Compile failed: ${e}`}const functions=document.getElementById("functions");for(;functions.firstChild;)functions.removeChild(functions.firstChild);functionElems=[],console.log(`bind: ${Object.getOwnPropertyNames(bind.exports)}`);for(const e in bind.exports){if(0<=["alloca","malloc","set","strcat","reverse","sqrt"].indexOf(e))continue;const t=bind.exports[e];if("function"!=typeof t)continue;const n=document.createElement("div"),o=document.createTextNode(e+"(");n.appendChild(o);const c=[];for(let e=0;e<t.length;e++){const o=document.createElement("label"),r=document.createElement("input");r.setAttribute("type","text"),r.value=1,o.appendChild(r),n.appendChild(o),e<t.length-1&&n.appendChild(document.createTextNode(", ")),c.push(r)}n.appendChild(document.createTextNode(")"));const r=document.createElement("button");r.innerHTML="Call",r.addEventListener("click",(()=>callFunc(bind,e))),n.appendChild(r),functions.appendChild(n),functionElems[e]=c}})))),document.getElementById("disasm").addEventListener("click",(()=>runCommon((e=>{const t=(0,_pkg_index_bg_js__WEBPACK_IMPORTED_MODULE_0__.M0)(e);document.getElementById("console").value=t})))),document.getElementById("clearCanvas").addEventListener("click",(()=>{const e=document.getElementById("canvas"),t=e.getBoundingClientRect();e.getContext("2d").clearRect(0,0,t.width,t.height)}));const samples=document.getElementById("samples");["hello.wscl","comment.wscl","fact.wscl","fibo.wscl","float.wscl","funcs.wscl","log.wscl","loop.wscl","string.wscl","strrepeat.wscl","struct.wscl","struct_infer.wscl","struct_nested.wscl","struct_freed.wscl","vector.wscl","field_assign.wscl","mandel.wscl","canvas.wscl","mandel_canvas.wscl","raytrace.wscl","raytrace_canvas.wscl"].forEach((e=>{const t=document.createElement("a");t.href="#",t.addEventListener("click",(async()=>{const t=await fetch("scripts/"+e),n=await t.text();let o=view.state.doc.length;const c=view.state.update({changes:{from:0,to:o},sequential:!0},{changes:{from:0,insert:n},sequential:!0});view.dispatch(c)})),t.innerHTML=e,samples.appendChild(t),samples.append(" ")}));let initState=_codemirror_state__WEBPACK_IMPORTED_MODULE_3__.$t.create({extensions:[codemirror__WEBPACK_IMPORTED_MODULE_4__.oQ,_codemirror_language__WEBPACK_IMPORTED_MODULE_5__.Tg.define(_parser__WEBPACK_IMPORTED_MODULE_2__.i)],doc:"pub let hello(x: i32, y: i32) = x + y"}),view=new codemirror__WEBPACK_IMPORTED_MODULE_6__.Lz({state:initState,parent:document.getElementById("highlighting")})},802:(e,t,n)=>{function o(e){return new RegExp("^(?:"+e.join("|")+")$","i")}n.d(t,{i:()=>a});var c=o(["malloc","set","strcat"]),r=o(["break","return","pub","let","if","else","for","in","to","struct","i32","i64","f32","f64","str"]),_=o(["\\(","{"]),l=o(["\\)","}"]),i=new RegExp("^(?:"+["\\)","}"].join("|")+")","i");function s(e,t){var n,o,c=e.next();return"/"===c&&e.eat("/")?(e.skipToEnd(),"comment"):"/"===c&&e.eat("*")?(t.cur=(e,t)=>{for(;null!=(c=e.next());)if("*"==c&&e.eat("/"))return t.cur=s,"blockComment";return"blockComment"},"blockComment"):'"'==c||"'"==c?(t.cur=(n=c,function(e,t){for(var o,c=!1;null!=(o=e.next())&&(o!=n||c);)c=!c&&"\\"==o;return c||(t.cur=s),"string"}))(e,t):"["==c&&/[\[=]/.test(e.peek())?(t.cur=(o=function(e){for(var t=0;e.eat("=");)++t;return e.eat("["),t}(e),function(e,t){for(var n,c=null;null!=(n=e.next());)if(null==c)"]"==n&&(c=0);else if("="==n)++c;else{if("]"==n&&c==o){t.cur=s;break}c=null}return"string"}))(e,t):/\d/.test(c)?(e.eatWhile(/[\w.%]/),"number"):/[\w_]/.test(c)?(e.eatWhile(/[\w\\\-_.]/),"variable"):null}const a={name:"wascal",startState:function(){return{basecol:0,indentDepth:0,cur:s}},token:function(e,t){if(e.eatSpace())return null;var n=t.cur(e,t),o=e.current();return"variable"==n&&(r.test(o)?n="keyword":c.test(o)&&(n="builtin")),"comment"!=n&&"string"!=n&&(_.test(o)?++t.indentDepth:l.test(o)&&--t.indentDepth),n},indent:function(e,t,n){var o=i.test(t);return e.basecol+n.unit*(e.indentDepth-(o?1:0))},languageData:{indentOnInput:/^\s*(?:else|\)|\})$/,commentTokens:{line:"--",block:{open:"--[[",close:"]]--"}}}}},903:(e,t,n)=>{let o;function c(e){o=e}n.d(t,{$I:()=>M,M0:()=>y,S9:()=>I,Vv:()=>h,bk:()=>B,lI:()=>c,mM:()=>k,wE:()=>v,yc:()=>C});let r=new("undefined"==typeof TextDecoder?(0,module.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});r.decode();let _=null;function l(){return null!==_&&0!==_.byteLength||(_=new Uint8Array(o.memory.buffer)),_}function i(e,t){return e>>>=0,r.decode(l().subarray(e,e+t))}const s=new Array(128).fill(void 0);s.push(void 0,null,!0,!1);let a=s.length;function u(e){a===s.length&&s.push(s.length+1);const t=a;return a=s[t],s[t]=e,t}function d(e){return s[e]}function m(e){const t=d(e);return function(e){e<132||(s[e]=a,a=e)}(e),t}let f=0,p=new("undefined"==typeof TextEncoder?(0,module.require)("util").TextEncoder:TextEncoder)("utf-8");const g="function"==typeof p.encodeInto?function(e,t){return p.encodeInto(e,t)}:function(e,t){const n=p.encode(e);return t.set(n),{read:e.length,written:n.length}};function E(e,t,n){if(void 0===n){const n=p.encode(e),o=t(n.length,1)>>>0;return l().subarray(o,o+n.length).set(n),f=n.length,o}let o=e.length,c=t(o,1)>>>0;const r=l();let _=0;for(;_<o;_++){const t=e.charCodeAt(_);if(t>127)break;r[c+_]=t}if(_!==o){0!==_&&(e=e.slice(_)),c=n(c,o,o=_+3*e.length,1)>>>0;const t=l().subarray(c+_,c+o);_+=g(e,t).written,c=n(c,o,_,1)>>>0}return f=_,c}let w=null;function b(){return(null===w||!0===w.buffer.detached||void 0===w.buffer.detached&&w.buffer!==o.memory.buffer)&&(w=new DataView(o.memory.buffer)),w}function h(e){let t,n;try{const u=o.__wbindgen_add_to_stack_pointer(-16),d=E(e,o.__wbindgen_malloc,o.__wbindgen_realloc),p=f;o.parse_ast(u,d,p);var c=b().getInt32(u+0,!0),r=b().getInt32(u+4,!0),_=b().getInt32(u+8,!0),l=b().getInt32(u+12,!0),s=c,a=r;if(l)throw s=0,a=0,m(_);return t=s,n=a,i(s,a)}finally{o.__wbindgen_add_to_stack_pointer(16),o.__wbindgen_free(t,n,1)}}function v(e){try{const c=o.__wbindgen_add_to_stack_pointer(-16),r=E(e,o.__wbindgen_malloc,o.__wbindgen_realloc),_=f;o.compile(c,r,_);var t=b().getInt32(c+0,!0),n=b().getInt32(c+4,!0);if(b().getInt32(c+8,!0))throw m(n);return m(t)}finally{o.__wbindgen_add_to_stack_pointer(16)}}function y(e){let t,n;try{const u=o.__wbindgen_add_to_stack_pointer(-16),d=E(e,o.__wbindgen_malloc,o.__wbindgen_realloc),p=f;o.disasm(u,d,p);var c=b().getInt32(u+0,!0),r=b().getInt32(u+4,!0),_=b().getInt32(u+8,!0),l=b().getInt32(u+12,!0),s=c,a=r;if(l)throw s=0,a=0,m(_);return t=s,n=a,i(s,a)}finally{o.__wbindgen_add_to_stack_pointer(16),o.__wbindgen_free(t,n,1)}}function C(e,t){return u(i(e,t))}function k(){return u([])}function I(e,t){d(e).push(m(t))}function M(e,t){var n,c,r=(n=e,c=t,n>>>=0,l().subarray(n/1,n/1+c)).slice();return o.__wbindgen_free(e,1*t,1),u(r)}function B(e){m(e)}},923:(e,t,n)=>{var o=n.w[e.id];for(var c in n.r(t),o)c&&(t[c]=o[c]);n(903),o[""]()}}]);